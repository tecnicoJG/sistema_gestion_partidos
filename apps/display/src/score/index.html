<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Marcador Padel</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header Section -->
      <header class="header">
        <div class="court-info">PISTA <span id="courtNumber">1</span></div>
        <div class="match-status" id="matchStatus">EN PARTIDA</div>
        <div class="current-time" id="currentTime">--:--</div>
      </header>

      <!-- Main Scoreboard -->
      <div class="scoreboard">
        <!-- Team 1 -->
        <div class="team" id="team-1">
          <div class="lead active" id="lead-T1">LEAD</div>
          <div class="scores">
            <div class="current-game-score">
              <div class="current-game-score-value" id="points-T1">30</div>
              <div class="current-game-score-label">PUNTUACION</div>
            </div>
            <div class="sets-won">
              <div class="sets-won-value" id="sets-T1">1</div>
              <div class="sets-won-label">SETS</div>
            </div>
            <div class="games-won">
              <div class="games-won-value" id="games-T1">2</div>
              <div class="games-won-label">JUEGOS</div>
            </div>
          </div>
          <div class="players">
            <div>
              <div class="player" id="player-1-1">
                <div class="text-scroll-container">
                  <div class="player-name">JUGADOR 1</div>
                </div>
                <div class="server-indicator"></div>
              </div>
            </div>
            <div>
              <div class="player serving" id="player-1-2">
                <div class="text-scroll-container">
                  <div class="player-name">JUGADOR 2</div>
                </div>
                <div class="server-indicator"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Team 2 -->
        <div class="team" id="team-2">
          <div class="lead" id="lead-T2">LEAD</div>
          <div class="scores">
            <div class="current-game-score">
              <div class="current-game-score-value" id="points-T2">15</div>
              <div class="current-game-score-label">PUNTUACION</div>
            </div>
            <div class="sets-won">
              <div class="sets-won-value" id="sets-T2">0</div>
              <div class="sets-won-label">SETS</div>
            </div>
            <div class="games-won">
              <div class="games-won-value" id="games-T2">4</div>
              <div class="games-won-label">JUEGOS</div>
            </div>
          </div>
          <div class="players">
            <div>
              <div class="player" id="player-2-1">
                <div class="text-scroll-container">
                  <div class="player-name">
                    <span>JUGADOR 1</span>
                    <span>JUGADOR 1</span>
                  </div>
                </div>
                <div class="server-indicator"></div>
              </div>
            </div>
            <div>
              <div class="player" id="player-2-2">
                <div class="text-scroll-container">
                  <div class="player-name">
                    <span>JUGADOR 2 asd dsd dsa</span>
                    <span>JUGADOR 2 asd dsd dsa</span>
                  </div>
                </div>
                <div class="server-indicator"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Match Info Footer -->
      <footer class="match-info">
        <div class="info-item">
          <span class="info-label">INICIO SESIÓN:</span>
          <span class="info-value" id="matchStart">--:--</span>
        </div>
        <div class="info-item">
          <span class="info-label">FIN SESIÓN:</span>
          <span class="info-value" id="matchStart">--:--</span>
        </div>
      </footer>
    </div>

    <script src="script.js"></script>
    <script>
      let score = {};

      function renamePlayer(name, team, player) {
        const playerNameContainer = document.getElementById(
          `player-${team}-${player}`
        );
        playerNameContainer.querySelectorAll("span").forEach((el) => {
          el.innerHTML = name;
        });
      }

      function initScrolling() {
        document.querySelectorAll(".player-name").forEach((el) => {
          const container = el.parentElement;

          // Remove scroll class & animation first
          container.classList.remove("scroll");
          el.style.animationDuration = "";
          el.style.animationPlayState = "";

          // Clear previous listener
          if (el._scrollListener) {
            el.removeEventListener("animationiteration", el._scrollListener);
            el._scrollListener = null;
          }

          // Clear previous timeout
          if (el._scrollTimeout) {
            clearTimeout(el._scrollTimeout);
            el._scrollTimeout = null;
          }

          // Only scroll if overflowing
          if (el.scrollWidth > container.clientWidth) {
            container.classList.add("scroll");

            const speed = 80; // px/s
            const pause = 5000; // ms
            const distance = el.scrollWidth / 2;
            const duration = distance / speed;

            el.style.setProperty("--scroll-distance", `-${distance}px`);
            el.style.animationDuration = `${duration}s`;

            // Start paused for initial delay
            el.style.animationPlayState = "paused";

            el._scrollTimeout = setTimeout(() => {
              el.style.animationPlayState = "running";
            }, pause);

            // Pause between loops
            const listener = () => {
              el.style.animationPlayState = "paused";
              el._scrollTimeout = setTimeout(() => {
                el.style.animationPlayState = "running";
              }, pause);
            };
            el.addEventListener("animationiteration", listener);
            el._scrollListener = listener;
          }
        });
      }

      // Initial run
      initScrolling();

      window.addEventListener("keydown", (e) => {
        switch (e.key) {
          case 1:
            break;
          case 2:
            break;
        }
      });

      // Debounced resize
      let resizeTimeout;
      window.addEventListener("resize", () => {
        clearTimeout(resizeTimeout);
        resizeTimeout = setTimeout(initScrolling, 200);
      });

      function updateTime() {
        const now = new Date();

        // Format as HH:MM (24-hour)
        const hours = String(now.getHours()).padStart(2, "0");
        const minutes = String(now.getMinutes()).padStart(2, "0");

        const timeDiv = document.getElementById("currentTime");
        if (timeDiv) {
          timeDiv.textContent = `${hours}:${minutes}`;
        }

        // Calculate ms until next full minute
        const msToNextMinute =
          (60 - now.getSeconds()) * 1000 - now.getMilliseconds();
        setTimeout(updateTime, msToNextMinute);
      }

      // Start immediately
      updateTime();
    </script>
  </body>
</html>
